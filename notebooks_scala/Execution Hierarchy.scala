{"version":"NotebookV1","origId":1965691013914977,"name":"Execution Hierarchy","language":"scala","commands":[{"version":"CommandV1","origId":1965691013914978,"guid":"fdaf52c4-fcfb-41f6-abc9-c35f92f70e03","subtype":"command","commandType":"auto","position":1.0,"command":"%run ./Create_DataFrames","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"13e9dfac-8baa-4b09-b181-91cf10215175"},{"version":"CommandV1","origId":1965691013914979,"guid":"24f84d94-cb14-4265-b201-965508b97d7c","subtype":"command","commandType":"auto","position":1.5,"command":"import org.apache.spark.sql.functions._","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"92d68d9c-713a-4e9a-91ca-e783693252dd"},{"version":"CommandV1","origId":1965691013914980,"guid":"06b312cb-c634-443d-89ab-35820b65836a","subtype":"command","commandType":"auto","position":2.0,"command":"val df = res49\n.join(addressDf, \n      customerDf(\"address_id\") === addressDf(\"address_id\"))\n.filter(year($\"birthdate\") > 1980)\n.groupBy(customerDf(\"demographics.education_status\")\n         ,addressDf(\"location_type\"))\n.agg(countDistinct(\"customer_id\").as(\"count\"))\n.where(\"location_type is not null\")\n.sort(desc(\"count\"))\n\n","commandVersion":230,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cf139b57-fada-4aa9-91f3-62e8bb70a63f"},{"version":"CommandV1","origId":1965691013914981,"guid":"a28caffe-68cc-4a95-b364-4fdb663ddca8","subtype":"command","commandType":"auto","position":2.125,"command":"df.explain(\"formatted\")","commandVersion":10,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6043de41-56ad-48cc-ae67-241494bef15b"},{"version":"CommandV1","origId":1965691013914982,"guid":"e69b5413-cedf-4a59-9402-0ab419c23613","subtype":"command","commandType":"auto","position":2.1875,"command":"spark.conf.get(\"spark.sql.shuffle.partitions\")","commandVersion":12,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5a0d0fbf-c0d7-4ed1-9dab-29ce28cc56e0"},{"version":"CommandV1","origId":1965691013914983,"guid":"8d882319-4835-47fe-ad8e-bb71e1f23550","subtype":"command","commandType":"auto","position":2.203125,"command":"spark.conf.set(\"spark.sql.shuffle.partitions\",50)","commandVersion":7,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d14e5658-6ac5-4501-9a4f-6bc227cb7c53"},{"version":"CommandV1","origId":1965691013914984,"guid":"3815ef09-6b96-4d35-9052-9a6746f77b5e","subtype":"command","commandType":"auto","position":2.21875,"command":"customerDf.rdd.getNumPartitions","commandVersion":7,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ed5ee15f-379b-408c-adae-e65d41dd62ff"},{"version":"CommandV1","origId":1965691013914985,"guid":"6f87a686-6dad-4d99-9c91-f1e155155e2c","subtype":"command","commandType":"auto","position":2.234375,"command":"addressDf.rdd.getNumPartitions","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a6e8572f-536c-4fdc-9b42-9fe4f92e73b1"},{"version":"CommandV1","origId":1965691013914986,"guid":"9d9b0e60-f7f6-425f-90c1-dd27ef6b0d72","subtype":"command","commandType":"auto","position":2.25,"command":"df.show","commandVersion":3,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ce8bd48d-f343-414d-bd7f-3d161fdcb15c"},{"version":"CommandV1","origId":1965691013914987,"guid":"7723187f-aa06-4dce-8aca-51e419cbd614","subtype":"command","commandType":"auto","position":2.5,"command":"df.explain(\"codegen\")","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2cbf6204-d36e-4db4-9844-c4d6b21e7d89"},{"version":"CommandV1","origId":1965691013914988,"guid":"4e861ade-817f-44e8-a7c7-935df784f80c","subtype":"command","commandType":"auto","position":3.0,"command":"df.explain(true)","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8264d03b-ed0f-4414-bfe1-98bea7a7566f"},{"version":"CommandV1","origId":1965691013914989,"guid":"bbe7354a-9068-4b28-8606-b41b50740e26","subtype":"command","commandType":"auto","position":4.0,"command":"spark.conf.set(\"spark.sql.shuffle.partitions\",10)","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"31ff4350-816f-4325-9a2e-5e5aca07ce9e"},{"version":"CommandV1","origId":1965691013914990,"guid":"9eac2ffb-98da-4b9e-a10a-4423c28c5c11","subtype":"command","commandType":"auto","position":4.5,"command":"customerDf.rdd.getNumPartitions","commandVersion":7,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"08c1fa33-606d-451d-9dd0-229fe4602d80"},{"version":"CommandV1","origId":1965691013914991,"guid":"c90be4cf-5693-4734-8d66-09d55866855d","subtype":"command","commandType":"auto","position":4.75,"command":"customerDf.repartition(2)","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0bb3ee28-1b58-4a2b-9563-027bfaf00c0a"},{"version":"CommandV1","origId":1965691013914992,"guid":"a7116de9-a05d-4437-a5f2-e9933bb17f92","subtype":"command","commandType":"auto","position":4.875,"command":"customerDf.coalesce(2)","commandVersion":7,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f44274f1-7d96-49b2-a8af-11530de5286d"},{"version":"CommandV1","origId":1965691013914993,"guid":"966dfc00-9fbc-46ed-b92a-f4c2e7a8f4a4","subtype":"command","commandType":"auto","position":4.9375,"command":"df.show","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"34de046a-8e70-4021-878b-65f547722426"},{"version":"CommandV1","origId":1965691013914994,"guid":"ba2e3704-2163-4333-9f0a-c916e7fba7d1","subtype":"command","commandType":"auto","position":5.0,"command":"df.show","commandVersion":3,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"96910f9f-405c-4c09-bd0f-a214a337c8b6"}],"dashboards":[],"guid":"88db3788-ae86-4755-9be9-8876608c4ed0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}