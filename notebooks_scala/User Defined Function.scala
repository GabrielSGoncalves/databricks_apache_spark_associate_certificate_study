{"version":"NotebookV1","origId":1965691013914995,"name":"User Defined Function","language":"scala","commands":[{"version":"CommandV1","origId":1965691013914996,"guid":"148f366d-8417-4e19-82a9-8e14c2db9988","subtype":"command","commandType":"auto","position":1.0,"command":"%run ./Create_DataFrames","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":true,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8442c6b2-bf85-4c2d-81d6-b13dbe968b6c"},{"version":"CommandV1","origId":1965691013914997,"guid":"fed97829-7963-4232-a1d9-35c75173bbc4","subtype":"command","commandType":"auto","position":2.0,"command":"import org.apache.spark.sql.functions._","commandVersion":13,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"374e0be8-783d-41b5-9076-1fbf1fe52576"},{"version":"CommandV1","origId":1965691013914998,"guid":"36b37342-74e5-45c3-8135-f0dd8f6ed022","subtype":"command","commandType":"auto","position":2.5,"command":"def stringConcat(sep:String,first:String,second:String): String = {\nreturn first + sep + second\n}","commandVersion":169,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"26413bfb-72a5-4adf-b50b-47bdf74c2d96"},{"version":"CommandV1","origId":1965691013914999,"guid":"e6a45713-510c-47ca-a436-ce07182c9d0c","subtype":"command","commandType":"auto","position":2.5625,"command":"%md\nRegister the function as DataFrame function","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0a5337c0-b2d0-431a-8f7c-7cc80cf4ece3"},{"version":"CommandV1","origId":1965691013915000,"guid":"ad7eadc2-98f6-493b-9cdb-b92409c36a8f","subtype":"command","commandType":"auto","position":3.09375,"command":"val stringConcat_udf = udf(stringConcat(_:String,_:String,_:String):String)","commandVersion":23,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d7f93dba-949f-4876-aaa5-77ec309a8ee9"},{"version":"CommandV1","origId":1965691013915001,"guid":"443f10f7-76b0-48c4-ada9-2a4dbe4d4e03","subtype":"command","commandType":"auto","position":3.359375,"command":"customerDf.select($\"firstname\",$\"lastname\",stringConcat_udf(lit(\" \"),'firstname,'lastname).as(\"fullName\")).show","commandVersion":43,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0e7de7aa-6864-4c25-9cc1-8ad50efb453d"},{"version":"CommandV1","origId":1965691013915002,"guid":"1d7e68d6-ed3b-4534-bbcd-b94fc95f4a44","subtype":"command","commandType":"auto","position":3.625,"command":"%md\nregister the function as SQL function","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"83f916d5-dd49-45fe-bc90-75c9fce5383e"},{"version":"CommandV1","origId":1965691013915003,"guid":"3b49a5de-93c9-453b-9480-b268af86ce14","subtype":"command","commandType":"auto","position":4.625,"command":"spark.udf.register(\"SQL_StringConcat_udf\",stringConcat(_:String,_:String,_:String):String)","commandVersion":18,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4da09aec-dca4-47ed-8335-b591ea264dbb"},{"version":"CommandV1","origId":1965691013915004,"guid":"f221f132-04d6-4b1b-8663-1f10ad0cd1cd","subtype":"command","commandType":"auto","position":5.625,"command":"customerDf.selectExpr(\"firstname\",\"lastname\",\"SQL_StringConcat_udf('->',firstname,lastname)\").show","commandVersion":44,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"240abfb2-b28d-4291-87b8-6e8835689a68"},{"version":"CommandV1","origId":1965691013915005,"guid":"f2d7a2dc-0aa4-4c82-9f8f-3846d0f93f36","subtype":"command","commandType":"auto","position":6.125,"command":"customerDf.write.saveAsTable(\"customer\")","commandVersion":14,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"395bcec8-7096-4b2b-88ed-9931198ee7e8"},{"version":"CommandV1","origId":1965691013915006,"guid":"1411f374-58d3-40f4-a354-16e0580b409e","subtype":"command","commandType":"auto","position":6.625,"command":"spark.sql(\"select firstname, lastname,stringConcat_udf(' ',firstname,lastname) as fullName from customer\").show","commandVersion":39,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"df50af3b-dc59-4335-a6ac-1b4ecba83fc1"}],"dashboards":[],"guid":"9bff64bb-f99d-42bf-aea1-feb1141201d3","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}