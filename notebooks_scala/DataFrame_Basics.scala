{"version":"NotebookV1","origId":1965691013914866,"name":"DataFrame_Basics","language":"scala","commands":[{"version":"CommandV1","origId":1965691013914867,"guid":"ee2f7574-36b9-4a3d-8ccf-90749602d504","subtype":"command","commandType":"auto","position":1.0,"command":"val customerDf = spark.read.format(\"json\")\n.option(\"inferSchema\",true)\n.schema(customerDfSchema_ST)\n// .schema(customerDfSchema_DDL)\n.load(\"/FileStore/tables/dcad_data/customer.json\")","commandVersion":54,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6577e736-3170-4576-805f-cabc6d951213"},{"version":"CommandV1","origId":1965691013914868,"guid":"f02840a4-af75-4199-a3c7-df5740881c96","subtype":"command","commandType":"auto","position":1.0625,"command":"val customerDfSchema_DDL = \"address_id INT,birth_country STRING,birthdate date,customer_id INT,demographics STRUCT<buy_potential: STRING, credit_rating: STRING, education_status: STRING, income_range: ARRAY<INT>, purchase_estimate: INT, vehicle_count: INT>,email_address STRING,firstname STRING,gender STRING,is_preffered_customer STRING,lastname STRING,salutation STRING\"","commandVersion":30,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3380f9c4-01fb-4e4a-bbcf-79738e4a8f9d"},{"version":"CommandV1","origId":1965691013914869,"guid":"e4dcad0a-9ef9-43aa-a2a8-5981964a3604","subtype":"command","commandType":"auto","position":1.06640625,"command":"import org.apache.spark.sql.types._","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9a466364-c790-486b-bec1-1b2c2881cfe4"},{"version":"CommandV1","origId":1965691013914870,"guid":"62d2353b-45ff-49bc-9806-57d981f37781","subtype":"command","commandType":"auto","position":1.0703125,"command":"val customerDfSchema_ST = StructType(\nArray(\nStructField(\"address_id\",IntegerType,true),\n                   StructField(\"birth_country\",StringType,true), \n                   StructField(\"birthdate\",DateType,true), \n                   StructField(\"customer_id\",IntegerType,true),\n                   StructField(\"demographics\",\n                               StructType(Array(\n                                                StructField(\"buy_potential\",StringType,true),\n                                                StructField(\"credit_rating\",StringType,true), \n                                                StructField(\"education_status\",StringType,true), \n                                                StructField(\"income_range\",ArrayType(IntegerType,true),true), \n                                                StructField(\"purchase_estimate\",IntegerType,true), \n                                                StructField(\"vehicle_count\",IntegerType,true))\n                                         ),true),  \n                   StructField(\"email_address\",StringType,true),\n                   StructField(\"firstname\",StringType,true),\n                   StructField(\"gender\",StringType,true), \n                   StructField(\"is_preffered_customer\",StringType,true),\n                   StructField(\"lastname\",StringType,true),\n                   StructField(\"salutation\",StringType,true)\n))\n","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f29bdf13-cf2b-4821-bb21-eea0e4bb6e41"},{"version":"CommandV1","origId":1965691013914871,"guid":"0148acff-4cf3-4faf-89cc-e1f9b141351a","subtype":"command","commandType":"auto","position":1.07421875,"command":"customerDf.printSchema","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cb22d3a3-6cba-40fa-a8cd-7c5d2d978228"},{"version":"CommandV1","origId":1965691013914872,"guid":"9ecc8949-dcd1-4512-909f-2a2a6ac940f5","subtype":"command","commandType":"auto","position":1.078125,"command":"customerDf.schema","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"db743ca0-1ca4-4837-b260-8ceeea7c17f8"},{"version":"CommandV1","origId":1965691013914873,"guid":"3c805a8c-d154-4c52-b423-f39548e7d848","subtype":"command","commandType":"auto","position":1.09375,"command":"customerDf.printSchema","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a4f09777-9389-4a8a-b422-aed0e9716c0d"},{"version":"CommandV1","origId":1965691013914874,"guid":"a20cb1ac-309d-4d7e-bc56-a9081037f829","subtype":"command","commandType":"auto","position":1.125,"command":"customerDf.printSchema()","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aba17803-e3b7-4a81-8c87-cd54888aef61"},{"version":"CommandV1","origId":1965691013914875,"guid":"c28f09f6-78b1-4a39-b68e-da3fd73bf5ac","subtype":"command","commandType":"auto","position":1.25,"command":"display(customerDf)","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2188.93505859375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5b39930e-ba32-4e0b-8250-c08912dee112"},{"version":"CommandV1","origId":1965691013914876,"guid":"53d4deee-1f25-47d8-9911-5420b1ee7078","subtype":"command","commandType":"auto","position":1.5,"command":"%fs head /FileStore/tables/dcad_data/customer.json","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"87fd6aad-dcbd-4a29-9471-e8072d60d519"},{"version":"CommandV1","origId":1965691013914877,"guid":"838007ef-18a5-4c96-96f0-ec8ccf7bc597","subtype":"command","commandType":"auto","position":2.0,"command":"%fs ls /FileStore/tables/dcad_data","commandVersion":13,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"587.423828125","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aa431ebe-da5f-44ff-b4fb-8d13f1c26ad1"}],"dashboards":[],"guid":"8391ec81-3f1c-4d62-bdcd-4d9b14837979","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}