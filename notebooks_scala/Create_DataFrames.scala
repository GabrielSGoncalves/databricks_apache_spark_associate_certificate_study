{"version":"NotebookV1","origId":1965691013915007,"name":"Create_DataFrames","language":"scala","commands":[{"version":"CommandV1","origId":1965691013915008,"guid":"92fc9d4c-530d-4932-a53a-787817389749","subtype":"command","commandType":"auto","position":0.5,"command":"val datFileReadOptions = Map(\"header\" -> \"true\"\n             ,\"delimiter\" -> \"|\"\n             ,\"inferSchema\" -> \"false\")\n\nval csvFileReadOptions = Map(\"header\" -> \"true\"\n             ,\"delimiter\" -> \",\"\n             ,\"inferSchema\" -> \"false\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f09b09b7-2fb4-4708-b36b-bdd2494bf0d8"},{"version":"CommandV1","origId":1965691013915009,"guid":"7a77c1c7-2bf5-4ade-afa5-a29de1fecd3a","subtype":"command","commandType":"auto","position":0.75,"command":"val webSalesSchema = \"ws_sold_date_sk LONG,ws_sold_time_sk LONG,ws_ship_date_sk LONG,ws_item_sk LONG,ws_bill_customer_sk LONG,ws_bill_cdemo_sk LONG,ws_bill_hdemo_sk LONG,ws_bill_addr_sk LONG,ws_ship_customer_sk LONG,ws_ship_cdemo_sk LONG,ws_ship_hdemo_sk LONG,ws_ship_addr_sk LONG,ws_web_page_sk LONG,ws_web_site_sk LONG,ws_ship_mode_sk LONG,ws_warehouse_sk LONG,ws_promo_sk LONG,ws_order_number LONG,ws_quantity INT,ws_wholesale_cost decimal(7,2),ws_list_price decimal(7,2),ws_sales_price decimal(7,2),ws_ext_discount_amt decimal(7,2),ws_ext_sales_price decimal(7,2),ws_ext_wholesale_cost decimal(7,2),ws_ext_list_price decimal(7,2),ws_ext_tax decimal(7,2),ws_coupon_amt decimal(7,2),ws_ext_ship_cost decimal(7,2),ws_net_paid decimal(7,2),ws_net_paid_inc_tax decimal(7,2),ws_net_paid_inc_ship decimal(7,2),ws_net_paid_inc_ship_tax decimal(7,2),ws_net_profit decimal(7,2)\"","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1f546190-bd0c-48bb-b0c4-a8d2e58f9696"},{"version":"CommandV1","origId":1965691013915010,"guid":"22c9e527-7b6c-4ace-96bd-474c09d6d654","subtype":"command","commandType":"auto","position":1.0,"command":"val customerDfSchema_DDL = \"address_id INT,birth_country STRING,birthdate date,customer_id INT,demographics STRUCT<buy_potential: STRING, credit_rating: STRING, education_status: STRING, income_range: ARRAY<INT>, purchase_estimate: INT, vehicle_count: INT>,email_address STRING,firstname STRING,gender STRING,is_preffered_customer STRING,lastname STRING,salutation STRING\"","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e18de03a-cc82-4153-ae8e-9d8d8c487300"},{"version":"CommandV1","origId":1965691013915011,"guid":"6ee2abac-2b60-4db3-bd7c-496764047807","subtype":"command","commandType":"auto","position":1.5,"command":"val itemSchema = \"i_item_sk LONG,i_item_id STRING,i_rec_start_date date,i_rec_end_date date,i_item_desc STRING,i_current_price decimal(7,2),i_wholesale_cost decimal(7,2),i_brand_id INT,i_brand STRING,i_class_id INT,i_class STRING,i_category_id INT,i_category STRING,i_manufact_id INT,i_manufact STRING,i_size STRING,i_formulation STRING,i_color STRING,i_units STRING,i_container STRING,i_manager_id INT,i_product_name STRING\"","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fe9c38d1-132a-4eb3-bf4e-30a7d3f5ed71"},{"version":"CommandV1","origId":1965691013915012,"guid":"6ba1ef39-0be0-4625-b043-c03030dfe0e9","subtype":"command","commandType":"auto","position":2.0,"command":"val customerDf = spark.read.format(\"json\")\n.schema(customerDfSchema_DDL)\n.load(\"/FileStore/tables/dcad_data/customer.json\")","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ead40110-9ed7-457a-98da-b928a885af0e"},{"version":"CommandV1","origId":1965691013915013,"guid":"a76cf767-95db-47f9-8ab0-34bce2672705","subtype":"command","commandType":"auto","position":3.0,"command":"val webSalesDf = spark.read.\noptions(csvFileReadOptions)\n.schema(webSalesSchema)\n.csv(\"/FileStore/tables/dcad_data/web_sales.csv\")","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"34d9a7ed-c3ff-476d-be9e-44a2f8747c21"},{"version":"CommandV1","origId":1965691013915014,"guid":"cb3456a1-f786-4342-8cf1-00b7107052ff","subtype":"command","commandType":"auto","position":3.5,"command":"val addressDf = spark.read.parquet(\"/FileStore/tables/dcad_data/address.parquet\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"489dcfb5-8275-43f4-99ff-11a467053e58"},{"version":"CommandV1","origId":1965691013915015,"guid":"f1a88bcf-b7e7-4fc5-8a12-73f68b31a5c5","subtype":"command","commandType":"auto","position":4.0,"command":"val itemDf = spark.read.\noptions(datFileReadOptions)\n.schema(itemSchema)\n.csv(\"/FileStore/tables/dcad_data/item.dat\")","commandVersion":23,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2bd5782d-ac31-49fc-bb93-2e9f2f4ae940"}],"dashboards":[],"guid":"0dad4de4-c391-41a1-9b07-5f3e4c97bfae","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}