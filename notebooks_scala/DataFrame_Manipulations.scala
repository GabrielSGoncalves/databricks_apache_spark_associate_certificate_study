{"version":"NotebookV1","origId":1965691013914878,"name":"DataFrame_Manipulations","language":"scala","commands":[{"version":"CommandV1","origId":1965691013914879,"guid":"7424944a-94bf-4a84-b5e2-28c4a602f435","subtype":"command","commandType":"auto","position":1.0,"command":"%run ./Create_DataFrames","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"110879d3-03dd-4bf7-95f7-c3029082a65c"},{"version":"CommandV1","origId":1965691013914880,"guid":"a12ad769-c3c2-4499-93d9-66306038436d","subtype":"script","commandType":"auto","position":1.1111111111111112,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">datFileReadOptions: scala.collection.immutable.Map[String,String] = Map(header -&gt; true, delimiter -&gt; |, inferSchema -&gt; false)\ncsvFileReadOptions: scala.collection.immutable.Map[String,String] = Map(header -&gt; true, delimiter -&gt; ,, inferSchema -&gt; false)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792866050,"submitTime":0,"finishTime":1601792866465,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f09b09b7-2fb4-4708-b36b-bdd2494bf0d8"},{"version":"CommandV1","origId":1965691013914881,"guid":"bcb0f477-27a1-415f-a8f7-9baf5632812f","subtype":"script","commandType":"auto","position":1.2222222222222223,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">webSalesSchema: String = ws_sold_date_sk LONG,ws_sold_time_sk LONG,ws_ship_date_sk LONG,ws_item_sk LONG,ws_bill_customer_sk LONG,ws_bill_cdemo_sk LONG,ws_bill_hdemo_sk LONG,ws_bill_addr_sk LONG,ws_ship_customer_sk LONG,ws_ship_cdemo_sk LONG,ws_ship_hdemo_sk LONG,ws_ship_addr_sk LONG,ws_web_page_sk LONG,ws_web_site_sk LONG,ws_ship_mode_sk LONG,ws_warehouse_sk LONG,ws_promo_sk LONG,ws_order_number LONG,ws_quantity INT,ws_wholesale_cost decimal(7,2),ws_list_price decimal(7,2),ws_sales_price decimal(7,2),ws_ext_discount_amt decimal(7,2),ws_ext_sales_price decimal(7,2),ws_ext_wholesale_cost decimal(7,2),ws_ext_list_price decimal(7,2),ws_ext_tax decimal(7,2),ws_coupon_amt decimal(7,2),ws_ext_ship_cost decimal(7,2),ws_net_paid decimal(7,2),ws_net_paid_inc_tax decimal(7,2),ws_net_paid_inc_ship decimal(7,2),ws_net_paid_inc_ship_tax decimal(7,2),ws_net_profit decimal(7,2)\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792866475,"submitTime":0,"finishTime":1601792866719,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1f546190-bd0c-48bb-b0c4-a8d2e58f9696"},{"version":"CommandV1","origId":1965691013914882,"guid":"09c0e9a2-9617-4841-8b82-8d2ed9e5a043","subtype":"script","commandType":"auto","position":1.3333333333333333,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">customerDfSchema_DDL: String = address_id INT,birth_country STRING,birthdate date,customer_id INT,demographics STRUCT&lt;buy_potential: STRING, credit_rating: STRING, education_status: STRING, income_range: ARRAY&lt;INT&gt;, purchase_estimate: INT, vehicle_count: INT&gt;,email_address STRING,firstname STRING,gender STRING,is_preffered_customer STRING,lastname STRING,salutation STRING\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792866726,"submitTime":0,"finishTime":1601792866992,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e18de03a-cc82-4153-ae8e-9d8d8c487300"},{"version":"CommandV1","origId":1965691013914883,"guid":"eb4e796f-be7f-4596-b659-c11f7f8cabb2","subtype":"script","commandType":"auto","position":1.4444444444444444,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">itemSchema: String = i_item_sk LONG,i_item_id STRING,i_rec_start_date date,i_rec_end_date date,i_item_desc STRING,i_current_price decimal(7,2),i_wholesale_cost decimal(7,2),i_brand_id INT,i_brand STRING,i_class_id INT,i_class STRING,i_category_id INT,i_category STRING,i_manufact_id INT,i_manufact STRING,i_size STRING,i_formulation STRING,i_color STRING,i_units STRING,i_container STRING,i_manager_id INT,i_product_name STRING\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792866998,"submitTime":0,"finishTime":1601792867224,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"fe9c38d1-132a-4eb3-bf4e-30a7d3f5ed71"},{"version":"CommandV1","origId":1965691013914884,"guid":"7c541a2c-00ba-439b-aac1-cfe519acdd7c","subtype":"command","commandType":"auto","position":1.5,"command":"import org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._","commandVersion":31,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"57a8356f-40af-4417-b4c9-4422d64313d1"},{"version":"CommandV1","origId":1965691013914885,"guid":"c6824638-d4b3-4ed5-abb1-7207fb104e59","subtype":"script","commandType":"auto","position":1.5555555555555556,"command":"","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">customerDf: org.apache.spark.sql.DataFrame = [address_id: int, birth_country: string ... 9 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"customerDf","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"address_id","type":"integer","nullable":true,"metadata":{}},{"name":"birth_country","type":"string","nullable":true,"metadata":{}},{"name":"birthdate","type":"date","nullable":true,"metadata":{}},{"name":"customer_id","type":"integer","nullable":true,"metadata":{}},{"name":"demographics","type":{"type":"struct","fields":[{"name":"buy_potential","type":"string","nullable":true,"metadata":{}},{"name":"credit_rating","type":"string","nullable":true,"metadata":{}},{"name":"education_status","type":"string","nullable":true,"metadata":{}},{"name":"income_range","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{}},{"name":"purchase_estimate","type":"integer","nullable":true,"metadata":{}},{"name":"vehicle_count","type":"integer","nullable":true,"metadata":{}}]},"nullable":true,"metadata":{}},{"name":"email_address","type":"string","nullable":true,"metadata":{}},{"name":"firstname","type":"string","nullable":true,"metadata":{}},{"name":"gender","type":"string","nullable":true,"metadata":{}},{"name":"is_preffered_customer","type":"string","nullable":true,"metadata":{}},{"name":"lastname","type":"string","nullable":true,"metadata":{}},{"name":"salutation","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792867232,"submitTime":0,"finishTime":1601792868080,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ead40110-9ed7-457a-98da-b928a885af0e"},{"version":"CommandV1","origId":1965691013914886,"guid":"2729255f-37a0-4c30-b186-78dbd0ab92e6","subtype":"script","commandType":"auto","position":1.6666666666666665,"command":"","commandVersion":8,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">webSalesDf: org.apache.spark.sql.DataFrame = [ws_sold_date_sk: bigint, ws_sold_time_sk: bigint ... 32 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"webSalesDf","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"ws_sold_date_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_sold_time_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_ship_date_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_item_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_bill_customer_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_bill_cdemo_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_bill_hdemo_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_bill_addr_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_ship_customer_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_ship_cdemo_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_ship_hdemo_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_ship_addr_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_web_page_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_web_site_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_ship_mode_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_warehouse_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_promo_sk","type":"long","nullable":true,"metadata":{}},{"name":"ws_order_number","type":"long","nullable":true,"metadata":{}},{"name":"ws_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ws_wholesale_cost","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_list_price","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_sales_price","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_ext_discount_amt","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_ext_sales_price","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_ext_wholesale_cost","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_ext_list_price","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_ext_tax","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_coupon_amt","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_ext_ship_cost","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_net_paid","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_tax","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship_tax","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"ws_net_profit","type":"decimal(7,2)","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792868089,"submitTime":0,"finishTime":1601792868840,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"34d9a7ed-c3ff-476d-be9e-44a2f8747c21"},{"version":"CommandV1","origId":1965691013914887,"guid":"344c52a4-65a4-46f5-bb3f-4d3ca6695c49","subtype":"script","commandType":"auto","position":1.7777777777777777,"command":"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">addressDf: org.apache.spark.sql.DataFrame = [address_id: bigint, country: string ... 6 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"addressDf","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"address_id","type":"long","nullable":true,"metadata":{}},{"name":"country","type":"string","nullable":true,"metadata":{}},{"name":"state","type":"string","nullable":true,"metadata":{}},{"name":"city","type":"string","nullable":true,"metadata":{}},{"name":"zip","type":"string","nullable":true,"metadata":{}},{"name":"street_name","type":"string","nullable":true,"metadata":{}},{"name":"street_number","type":"string","nullable":true,"metadata":{}},{"name":"location_type","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792868845,"submitTime":0,"finishTime":1601792869868,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"489dcfb5-8275-43f4-99ff-11a467053e58"},{"version":"CommandV1","origId":1965691013914888,"guid":"7009949c-f9c6-4ba0-9a81-16a336378d76","subtype":"script","commandType":"auto","position":1.8888888888888888,"command":"","commandVersion":21,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">itemDf: org.apache.spark.sql.DataFrame = [i_item_sk: bigint, i_item_id: string ... 20 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"itemDf","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"i_item_sk","type":"long","nullable":true,"metadata":{}},{"name":"i_item_id","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_start_date","type":"date","nullable":true,"metadata":{}},{"name":"i_rec_end_date","type":"date","nullable":true,"metadata":{}},{"name":"i_item_desc","type":"string","nullable":true,"metadata":{}},{"name":"i_current_price","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"i_wholesale_cost","type":"decimal(7,2)","nullable":true,"metadata":{}},{"name":"i_brand_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_brand","type":"string","nullable":true,"metadata":{}},{"name":"i_class_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_class","type":"string","nullable":true,"metadata":{}},{"name":"i_category_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_category","type":"string","nullable":true,"metadata":{}},{"name":"i_manufact_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_manufact","type":"string","nullable":true,"metadata":{}},{"name":"i_size","type":"string","nullable":true,"metadata":{}},{"name":"i_formulation","type":"string","nullable":true,"metadata":{}},{"name":"i_color","type":"string","nullable":true,"metadata":{}},{"name":"i_units","type":"string","nullable":true,"metadata":{}},{"name":"i_container","type":"string","nullable":true,"metadata":{}},{"name":"i_manager_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_product_name","type":"string","nullable":true,"metadata":{}}]},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1601792869875,"submitTime":0,"finishTime":1601792870620,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["97d6db6f-72b2-40b3-a41f-652cdc982472"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2bd5782d-ac31-49fc-bb93-2e9f2f4ae940"},{"version":"CommandV1","origId":1965691013914889,"guid":"fb75c75e-87e3-467a-9357-f51cbd7d454b","subtype":"command","commandType":"auto","position":2.0,"command":"customerDf.select(\"firstname\",\"lastname\",\"demographics\",\"demographics.credit_rating\")","commandVersion":29,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"41056b26-031c-45ca-a2ee-e4e197f7d2f2"},{"version":"CommandV1","origId":1965691013914890,"guid":"c3ba2023-95ff-49e7-944b-9674ad546eb9","subtype":"command","commandType":"auto","position":3.5,"command":"import org.apache.spark.sql.functions.{col,expr,column}","commandVersion":18,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"75575eee-52b0-41c9-bc75-16f1c40b362c"},{"version":"CommandV1","origId":1965691013914891,"guid":"27a42a03-ace7-418b-b966-878b906a5639","subtype":"command","commandType":"auto","position":4.0,"command":"customerDf.select($\"firstname\",'lastname,col(\"demographics.education_status\"),\n                 column(\"demographics.credit_rating\"),\n                 customerDf.col(\"salutation\"),\n                 expr(\"concat(firstname,lastname) name\"))","commandVersion":65,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c65e4ad6-5529-4560-84b5-0464c83226df"},{"version":"CommandV1","origId":1965691013914892,"guid":"e4b080d3-7978-45b8-be81-8d20ad91b0d8","subtype":"command","commandType":"auto","position":6.0,"command":"customerDf.select(\"firstname\",$\"lastname\")","commandVersion":13,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5ed3cda4-ca4e-42ff-9481-fe676210faeb"},{"version":"CommandV1","origId":1965691013914893,"guid":"38f32269-5c2e-4de5-aec7-cb1f44095e5c","subtype":"command","commandType":"auto","position":7.0,"command":"customerDf.selectExpr(\"birthdate birthday\", \"year(birthdate) birthyear\")","commandVersion":27,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"78e89a16-c7ef-4ae0-8681-5a20c3297146"},{"version":"CommandV1","origId":1965691013914894,"guid":"33c77d70-cc87-46b9-995a-516fbdf56123","subtype":"command","commandType":"auto","position":9.0,"command":"customerDf.columns","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c89dde71-9952-4993-84f5-d1ea95e6f6cd"},{"version":"CommandV1","origId":1965691013914895,"guid":"637a85dc-3e6d-43d5-adc8-a153f573ea6e","subtype":"command","commandType":"auto","position":10.0,"command":"customerDf.withColumnRenamed($\"email_address\",\"mail\")","commandVersion":22,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0149efce-aae3-42d6-b513-77ec1690701a"},{"version":"CommandV1","origId":1965691013914896,"guid":"28c1c016-7d5e-4894-b821-fd8ab9d85728","subtype":"command","commandType":"auto","position":11.0,"command":"customerDf.printSchema","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"87bae23d-38d5-423f-aa92-13dce000c48b"},{"version":"CommandV1","origId":1965691013914897,"guid":"fca67e25-0da8-454a-a334-594241a5023c","subtype":"command","commandType":"auto","position":12.0,"command":"customerDf.printSchema","commandVersion":7,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a6e96c45-a752-4b41-a9cb-4f5301becafa"},{"version":"CommandV1","origId":1965691013914898,"guid":"dee0d200-5866-479e-a886-f3367838fe4d","subtype":"command","commandType":"auto","position":12.5,"command":"import org.apache.spark.sql.types._","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3bf65532-9c65-476c-818b-6315b0924fc0"},{"version":"CommandV1","origId":1965691013914899,"guid":"63b102e9-4d33-48d8-b698-cccf5263b668","subtype":"command","commandType":"auto","position":13.0,"command":"customerDf.select($\"address_id\".cast(\"long\"),$\"birthdate\".cast(StringType))","commandVersion":23,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e4114a22-32bb-45d4-8ca0-90a140e785d7"},{"version":"CommandV1","origId":1965691013914900,"guid":"fe1ea9b5-a6a0-404b-9879-e19a24290f06","subtype":"command","commandType":"auto","position":14.0,"command":"customerDf.selectExpr(\"cast(address_id as string)\",\"cast(demographics.income_range[0] as double) lowerBound\")","commandVersion":35,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7b53416a-d307-4278-9111-f88b067f8612"},{"version":"CommandV1","origId":1965691013914901,"guid":"5588e43f-e700-49e5-adea-ccc30af4f387","subtype":"command","commandType":"auto","position":14.5,"command":"display(customerDf.select(\"address_id\",\"demographics.income_range\"))","commandVersion":26,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"275.9833984375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cd10e3af-b635-4e40-8c77-72fd8bbc8e69"},{"version":"CommandV1","origId":1965691013914902,"guid":"01fce70c-2123-46c7-b9b0-38b572436ac1","subtype":"command","commandType":"auto","position":16.0,"command":"customerDf.columns.size","commandVersion":6,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a82156df-2c0c-49cd-9815-c36275de5dcd"},{"version":"CommandV1","origId":1965691013914903,"guid":"974e5431-ce37-4c06-861e-e05758694e78","subtype":"command","commandType":"auto","position":16.5,"command":"import org.apache.spark.sql.functions._","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a628099a-6772-4b82-b346-76873453aa1c"},{"version":"CommandV1","origId":1965691013914904,"guid":"0d16a1f7-90ad-4f50-bac5-de91b43d52ef","subtype":"command","commandType":"auto","position":17.0,"command":"customerDf.withColumn(\"fullname\",expr(\"address_id + 1\"))","commandVersion":49,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d527a4a6-c165-45e5-87bf-d223e3265da1"},{"version":"CommandV1","origId":1965691013914905,"guid":"5c4548c9-98c5-438c-ac70-3c320accf4b6","subtype":"command","commandType":"auto","position":19.0,"command":"customerDf.columns","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b6f5ef09-1016-4967-b8cd-fdbe236594a2"},{"version":"CommandV1","origId":1965691013914906,"guid":"6f0a3331-de3c-4eff-adc5-0ddd00d2875b","subtype":"command","commandType":"auto","position":20.0,"command":"customerDf.drop(\"address_id\",\"birth_country\",\"lkajkdjf\").columns","commandVersion":24,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ccdb173c-f818-4939-890d-7207c7e17ea7"},{"version":"CommandV1","origId":1965691013914907,"guid":"6147e3e8-adfa-4356-a996-25a19da56746","subtype":"command","commandType":"auto","position":21.0,"command":"customerDf.drop($\"lastname\",$\"firstname\").columns","commandVersion":15,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"35e9e0c9-8a43-4ecf-b299-b3f9b236cbed"},{"version":"CommandV1","origId":1965691013914908,"guid":"6178f232-266f-443c-8e82-b641f471db70","subtype":"command","commandType":"auto","position":22.0,"command":"val salesStatDf = webSalesDf.select(\n\"ws_order_number\",\n\"ws_item_sk\",\n  \"ws_quantity\",\n  \"ws_net_paid\",\n  \"ws_net_profit\",\n  \"ws_wholesale_cost\"\n)","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"09454153-6cc6-4924-928c-7b3b50e80655"},{"version":"CommandV1","origId":1965691013914909,"guid":"cf0907ca-89da-4078-b050-7a5df03a2ad6","subtype":"command","commandType":"auto","position":23.0,"command":"val salesPerfDf = salesStatDf\n.withColumn(\"expected_net_paid\", $\"ws_quantity\" * $\"ws_wholesale_cost\")\n.withColumn(\"calculated_profit\", $\"ws_net_paid\" - $\"expected_net_paid\")\n.withColumn(\"unit_price\",expr(\"ws_wholesale_cost / ws_quantity\"))\n.withColumn(\"rounded_unitPrice\",round($\"unit_price\",2))\n.withColumn(\"brounded_unitPrice\",bround($\"unit_price\",3))","commandVersion":43,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a97038a7-2a61-4b2f-b4e7-83656c0d78ca"},{"version":"CommandV1","origId":1965691013914910,"guid":"fef1a363-2c0c-4c1c-ae4b-567da3efae1b","subtype":"command","commandType":"auto","position":24.0,"command":"display(salesPerfDf)","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1483.52099609375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"22a9face-dba3-40f1-891d-737aab476b67"},{"version":"CommandV1","origId":1965691013914911,"guid":"f36d05b4-ba58-4763-8da9-5d986e0d03e8","subtype":"command","commandType":"auto","position":25.0,"command":"val Df = customerDf\n.withColumnRenamed(\"email_address\",\"mail\")\n.withColumn(\"developer_site\",lit(\"insightahead.com\"))\n.drop(\"birth_country\",\"address_id\")\n.filter(dayofmonth($\"birthdate\") < 20)","commandVersion":68,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"454fadd8-6ed7-4ed6-9193-f3fa2b503198"},{"version":"CommandV1","origId":1965691013914912,"guid":"2d582761-43d5-4230-9fad-19ccdb2c66a6","subtype":"command","commandType":"auto","position":25.5,"command":"customerDf.explain(\"formatted\")","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d55fcc7-5b05-4477-8591-a0afbbb69f03"},{"version":"CommandV1","origId":1965691013914913,"guid":"97f88f42-5a35-4fa5-85c5-4169f4294a87","subtype":"command","commandType":"auto","position":26.0,"command":"Df.explain(\"formatted\")","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"19c4304c-841e-40ec-b3a1-b3e31de6ca94"},{"version":"CommandV1","origId":1965691013914914,"guid":"a08cee72-3951-4881-b1f8-217104fd8c4b","subtype":"command","commandType":"auto","position":27.0,"command":"val filtered = customerDf\n.where(year($\"birthdate\") > 1980)\n.filter(month($\"birthdate\") === 1 )\n.where(\"day(birthdate) > 15\")\n.filter($\"birth_country\" =!= \"UNITED STATES\" )\n.select(\"firstname\",\"lastname\",\"birthdate\",\"birth_country\")","commandVersion":101,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2b218c33-cfae-46c7-8367-21eda27c8a0f"},{"version":"CommandV1","origId":1965691013914915,"guid":"bc1ca0f1-4132-4800-80dd-83c84711661f","subtype":"command","commandType":"auto","position":28.0,"command":"filtered.show","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8f2c1f0a-a155-4ef4-b352-0a1192485635"},{"version":"CommandV1","origId":1965691013914916,"guid":"29b1dbf9-dda4-4046-a870-cdc71bb39fab","subtype":"command","commandType":"auto","position":29.0,"command":"val demoDf = List(\n  (1,\"Monday\"), (1,\"Monday\"),\n  (2,\"Tuesday\"),  (3,\"Tuesday\"),\n  (3,\"Wednesday\"), (4,\"Thursday\"),\n  (5,\"Friday\"),  (6,\"Saturday\"),\n  (7,\"Sunday\")).toDF(\"id\",\"name\")","commandVersion":10,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"eb656cfd-2771-455c-bc4f-a3199423e95a"},{"version":"CommandV1","origId":1965691013914917,"guid":"ca4b4d6b-3af4-4089-bc02-802fd3d873af","subtype":"command","commandType":"auto","position":30.0,"command":"demoDf.show","commandVersion":3,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a38b487a-bd1f-4b3b-b04a-368efcc52898"},{"version":"CommandV1","origId":1965691013914918,"guid":"45ef576e-72ec-4c11-8d5f-946cdd01f0b8","subtype":"command","commandType":"auto","position":31.0,"command":"demoDf.distinct.show","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d8de6564-83be-4372-b51a-ce3d7d9fbccf"},{"version":"CommandV1","origId":1965691013914919,"guid":"d2eb9565-672c-4b82-ac8f-46885879b9f0","subtype":"command","commandType":"auto","position":32.0,"command":"demoDf.dropDuplicates(\"name\").show","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4e5906a7-4e9b-46b4-b806-075daab628fc"},{"version":"CommandV1","origId":1965691013914920,"guid":"4417662a-89ba-4d69-b270-7a55c8bd0ef6","subtype":"command","commandType":"auto","position":33.0,"command":"demoDf.dropDuplicates(List(\"name\",\"id\")).show","commandVersion":14,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cf002d9f-e224-498d-a61c-3f3d5cee6dfa"},{"version":"CommandV1","origId":1965691013914921,"guid":"233f6050-6134-4200-9af9-e74d43455b67","subtype":"command","commandType":"auto","position":33.5,"command":"demoDf.distinct.show","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c4bddba0-0689-4b2e-95d9-47479545354d"},{"version":"CommandV1","origId":1965691013914922,"guid":"80d1a736-0446-4e9b-9aae-77805d8e4ad5","subtype":"command","commandType":"auto","position":34.0,"command":"demoDf.dropDuplicates.show","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1229c109-41e3-447c-bd69-613c07e674ea"},{"version":"CommandV1","origId":1965691013914923,"guid":"d9bc8ac6-4919-4b27-b05f-d3daca8514f6","subtype":"command","commandType":"auto","position":35.0,"command":"val Dfn = customerDf.selectExpr(\"salutation\",\"firstname\",\"lastname\",\"email_address\",\"year(birthdate) birthyear \")","commandVersion":3,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"72bdd4f8-9224-4fad-bfd9-70de2b93217b"},{"version":"CommandV1","origId":1965691013914924,"guid":"76cc813a-7149-4d95-85d3-873da659367f","subtype":"command","commandType":"auto","position":36.0,"command":"display(Dfn)","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2796fa59-c2ef-4ff3-8698-346fa6d3d01e"},{"version":"CommandV1","origId":1965691013914925,"guid":"df2ba364-9fe2-4170-b7c9-acade29c7167","subtype":"command","commandType":"auto","position":37.0,"command":"Dfn.count","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f66f5a88-4da3-4173-827b-216cef26f279"},{"version":"CommandV1","origId":1965691013914926,"guid":"6c42502d-0251-4139-8aec-b492bb8e8a0f","subtype":"command","commandType":"auto","position":37.5,"command":"Dfn.where($\"salutation\".isNotNull).count","commandVersion":3,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"99c45f96-96df-4078-bfa5-a9b5f9f0087d"},{"version":"CommandV1","origId":1965691013914927,"guid":"837fc73c-2672-4f6e-8cc2-1ea4fd80feff","subtype":"command","commandType":"auto","position":37.75,"command":"Dfn.where($\"salutation\" === null).count","commandVersion":12,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a1fe84bd-3acc-4935-a822-ee0f11d14f0c"},{"version":"CommandV1","origId":1965691013914928,"guid":"31d07d03-1a81-4f44-a99d-275ba5f9f8cf","subtype":"command","commandType":"auto","position":37.875,"command":"Dfn.where($\"salutation\".isNull).count","commandVersion":2,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3c7da8ea-27ac-4899-999f-9dabad84aa70"},{"version":"CommandV1","origId":1965691013914929,"guid":"47ad3334-70f1-49e8-bb7c-56b3b6c45632","subtype":"command","commandType":"auto","position":38.0,"command":"display(Dfn.where($\"salutation\".isNull))","commandVersion":20,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e39021d0-4dbc-4444-b016-67ac1b887114"},{"version":"CommandV1","origId":1965691013914930,"guid":"f1782b87-139b-4873-9b82-e513272b78c1","subtype":"command","commandType":"auto","position":38.5,"command":"Dfn.na.drop(how=\"all\").count","commandVersion":2,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cec0bb7e-87a8-4cd8-b5a8-2e51888a15f8"},{"version":"CommandV1","origId":1965691013914931,"guid":"5f507ba3-545d-4aa0-899f-c82b1ef8460a","subtype":"command","commandType":"auto","position":39.0,"command":"display(Dfn.na.drop(how=\"all\"))","commandVersion":12,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"75ac40e1-9b31-47da-91c8-c0eb544a1fc1"},{"version":"CommandV1","origId":1965691013914932,"guid":"76969df3-fec8-4e4c-9ca2-2ac9d2d84e7d","subtype":"command","commandType":"auto","position":40.0,"command":"display(Dfn.na.drop(\"any\"))","commandVersion":14,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"959f31b8-a465-42ac-9301-e266342738dc"},{"version":"CommandV1","origId":1965691013914933,"guid":"c9dcda54-224b-4d89-be54-d347e6a7ce06","subtype":"command","commandType":"auto","position":41.0,"command":"display(Dfn.na.drop(\"any\",Seq(\"firstname\",\"lastname\")))","commandVersion":19,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9fb4b0f8-aa59-41de-b29a-0d584e76db73"},{"version":"CommandV1","origId":1965691013914934,"guid":"8e9ab608-80a8-4de1-8e3d-47f1ce8f5b1a","subtype":"command","commandType":"auto","position":42.0,"command":"display(Dfn.na.fill(1234))","commandVersion":13,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2f325243-1e7c-480a-84db-998576dd1a31"},{"version":"CommandV1","origId":1965691013914935,"guid":"8392e497-1cdf-4573-a5c9-e0b30c5a2b2d","subtype":"command","commandType":"auto","position":43.0,"command":"display(Dfn.na.fill(Map(\"salutation\" -> \"UNKNOW\",\"firstname\" -> \"John\", \"lastname\" -> \"Doe\", \"birthyear\" -> 9999)))","commandVersion":45,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"764.1396484375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"510a53b2-e351-44fb-ab5b-46ef36f14470"},{"version":"CommandV1","origId":1965691013914936,"guid":"c430e795-e485-4771-8420-e772abe4c114","subtype":"command","commandType":"auto","position":44.0,"command":"display(customerDf\n.na.drop(\"any\")\n.sort($\"firstname\",$\"lastname\".desc)\n.select(\"firstname\",\"lastname\",\"birthdate\"))","commandVersion":70,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"354.44482421875","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ecbe9e32-ba0b-44e3-b631-fcade1442e15"},{"version":"CommandV1","origId":1965691013914937,"guid":"ca84abf0-1d39-4bfd-846a-8c70731bba3d","subtype":"command","commandType":"auto","position":44.75,"command":"webSalesDf.printSchema","commandVersion":32,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cb09f7f8-d0fb-46ac-8ca8-a66803158ad2"},{"version":"CommandV1","origId":1965691013914938,"guid":"9c527765-be5f-4163-a06c-8d50ffb2c730","subtype":"command","commandType":"auto","position":45.5,"command":"val customerPurchases = webSalesDf.selectExpr(\"ws_bill_customer_sk customer_id\",\"ws_item_sk item_id\")","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9fba1b3d-2a75-41a2-9966-a2485da239e2"},{"version":"CommandV1","origId":1965691013914939,"guid":"f334ccdd-a01a-4126-a6d4-514e9e871dfc","subtype":"command","commandType":"auto","position":46.5,"command":"customerPurchases.show","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0a378254-7999-4145-ab64-701fe643415e"},{"version":"CommandV1","origId":1965691013914940,"guid":"8f9e53c0-0463-47d0-a508-2e11d2bceb9f","subtype":"command","commandType":"auto","position":47.5,"command":"customerPurchases.groupBy(\"customer_id\").agg(count(\"item_id\").alias(\"item_count\")).show","commandVersion":32,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6e5dd50d-d138-4f0d-acb0-223072d0ebfc"},{"version":"CommandV1","origId":1965691013914941,"guid":"96385b0c-6822-445c-b289-ac63387fe654","subtype":"command","commandType":"auto","position":48.0,"command":"customerDf.select(year($\"birthdate\")).show","commandVersion":16,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"77c71302-96c9-4a7f-9587-59a80550a473"},{"version":"CommandV1","origId":1965691013914942,"guid":"613ba7ef-8c3c-4be4-9106-1d7b7d05c3eb","subtype":"command","commandType":"auto","position":48.5,"command":"webSalesDf.agg(\nmax(\"ws_sales_price\"),\nmin(\"ws_sales_price\"),\navg(\"ws_sales_price\"),\nmean(\"ws_sales_price\"),\ncount(\"ws_sales_price\")\n)\n.show","commandVersion":54,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9e810996-6487-4835-bcd8-589f152f3b6d"},{"version":"CommandV1","origId":1965691013914943,"guid":"dda07c5c-395f-48ca-86e3-bd556039649d","subtype":"command","commandType":"auto","position":49.5,"command":"webSalesDf.count","commandVersion":9,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c09fd66f-1374-481a-a775-0861f7dd298c"},{"version":"CommandV1","origId":1965691013914944,"guid":"6982d3f5-807e-46e8-8c13-2221681ab9df","subtype":"command","commandType":"auto","position":50.5,"command":"webSalesDf.select(count(\"*\")).show","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d15f7ff4-9693-4df6-bab6-16857f5e3c95"},{"version":"CommandV1","origId":1965691013914945,"guid":"baaa85fb-a0d7-4688-8655-ba4e4b13677e","subtype":"command","commandType":"auto","position":51.5,"command":"webSalesDf.select(count(\"ws_sales_price\")).show","commandVersion":6,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aaa126f2-d83e-48f9-a98d-f2f11efff734"},{"version":"CommandV1","origId":1965691013914946,"guid":"6a296e5a-4bd8-4266-8b80-6fe9e4a851e8","subtype":"command","commandType":"auto","position":52.5,"command":"display(webSalesDf.describe(\"ws_sales_price\"))","commandVersion":22,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1383.93505859375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e79c0504-91e3-45aa-b724-56e133861093"},{"version":"CommandV1","origId":1965691013914947,"guid":"123b8760-6856-4c1f-8e54-ad3f9b08a2d3","subtype":"command","commandType":"auto","position":53.5,"command":"display(webSalesDf.summary(\"stddev\"))","commandVersion":12,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"5267.8427734375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d12aef3f-5c4b-4a07-a30f-58d98811cf3a"},{"version":"CommandV1","origId":1965691013914948,"guid":"2cb27a89-a73d-4d1b-a4f5-718aa2170519","subtype":"command","commandType":"auto","position":54.5,"command":"display(customerDf.groupBy(\n  customerDf(\"birth_country\"), $\"birthdate\")\n        .agg(count(\"*\").as(\"count\"))\n       .sort(desc(\"count\")))","commandVersion":64,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"436.05029296875","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6c4d6a3b-d5fd-40c7-be5c-3c6e0aa3cdf8"},{"version":"CommandV1","origId":1965691013914949,"guid":"ad06e923-ec91-40ad-9ebd-6d3b218e486f","subtype":"command","commandType":"auto","position":55.25,"command":"display(addressDf)","commandVersion":6,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"978.71240234375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a0a44c00-3fc7-41c2-88fa-a26e8f63ccee"},{"version":"CommandV1","origId":1965691013914950,"guid":"cd465a87-11ef-4523-9262-cd65b3111f44","subtype":"command","commandType":"auto","position":56.25,"command":"display(customerDf)","commandVersion":7,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"2187.93505859375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ad671eb0-c0ea-44bb-a400-6fcd7790bfc8"},{"version":"CommandV1","origId":1965691013914951,"guid":"fbdbe92f-0905-42b2-9727-90c2154beb6e","subtype":"command","commandType":"auto","position":57.25,"command":"val customerWithAddress =\ncustomerDf.join(addressDf, customerDf.col(\"address_id\") === addressDf.col(\"address_id\"),\"inner\")\n.select(\"customer_id\"\n       ,\"firstname\"\n       ,\"lastname\"\n       ,\"demographics.education_status\"\n       ,\"location_type\"\n       ,\"country\"\n       ,\"city\"\n       ,\"street_name\"\n      )","commandVersion":119,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2204ef51-0442-4403-aea4-c2a72cddcf0c"},{"version":"CommandV1","origId":1965691013914952,"guid":"e94e069a-0ab3-4039-9bcc-17bf6b81dcc0","subtype":"command","commandType":"auto","position":58.25,"command":"display(customerWithAddress)","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"991.0078125","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a42f40ec-8715-4d4c-ab42-3ed218db8790"},{"version":"CommandV1","origId":1965691013914953,"guid":"7be908ff-523d-43ff-8eca-5c8fea7ef45e","subtype":"command","commandType":"auto","position":59.25,"command":"webSalesDf.select(countDistinct(\"ws_item_sk\")).show","commandVersion":20,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3e2091ea-0f4f-4426-9452-6bc39fbfb7df"},{"version":"CommandV1","origId":1965691013914954,"guid":"e5353dcf-16f2-4bab-943c-c19c42e8f3d9","subtype":"command","commandType":"auto","position":59.75,"command":"%fs ls /FileStore/tables/dcad_data","commandVersion":22,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"586.423828125","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d788b75-00b3-4b36-97d4-32bc5190254b"},{"version":"CommandV1","origId":1965691013914955,"guid":"a3e71e80-38db-40bc-9da3-b929c5dc5a89","subtype":"command","commandType":"auto","position":61.25,"command":"webSalesDf","commandVersion":6,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"1d0cb119-f4a1-4290-9e0f-f706ad4fadfd"},{"version":"CommandV1","origId":1965691013914956,"guid":"c086a26c-f555-4271-8d65-592163d42d59","subtype":"command","commandType":"auto","position":61.625,"command":"webSalesDf.where(\"ws_bill_customer_sk = 45721\").count","commandVersion":14,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"cfa9cb9b-69ff-46c2-8f59-fb4c757f99d9"},{"version":"CommandV1","origId":1965691013914957,"guid":"66fc17a0-e929-4e79-b043-738fe645d64f","subtype":"command","commandType":"auto","position":62.625,"command":"// display(\nwebSalesDf.join(customerDf, $\"customer_id\" === $\"ws_bill_customer_sk\",\"left\")\n.select(\"customer_id\",\"ws_bill_customer_sk\",\"*\")\n.where(\"customer_id is null\")\n  .count\n//   )","commandVersion":48,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"7159.23583984375","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8d48dc25-46b6-4bed-9270-5e559740328e"},{"version":"CommandV1","origId":1965691013914958,"guid":"7b2dead0-5dce-4d1a-aedc-e292db2bb950","subtype":"command","commandType":"auto","position":63.625,"command":"webSalesDf.where(\"ws_bill_customer_sk is null\").count","commandVersion":10,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"753e25dd-5eee-47bc-8442-efc57c50cece"},{"version":"CommandV1","origId":1965691013914959,"guid":"0b33e188-7e46-4bfe-bf3a-719a9e6efd94","subtype":"command","commandType":"auto","position":64.625,"command":"customerDf.select(\"firstname\",\"lastname\",\"customer_id\")","commandVersion":21,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"536d9f97-10c9-410c-adaf-8a50c3d5b3b7"},{"version":"CommandV1","origId":1965691013914960,"guid":"8d394788-c38d-4d81-b2ae-42b363ed9e64","subtype":"command","commandType":"auto","position":65.625,"command":"val df1 = customerDf\n.select(\"firstname\",\"lastname\",\"customer_id\")\n// .withColumn(\"from\",lit(\"df1\"))","commandVersion":43,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5e18a670-dd96-4425-be24-bc1ab8c2c4ea"},{"version":"CommandV1","origId":1965691013914961,"guid":"bb95cf24-bf66-4a91-89f9-3296dd3d78f1","subtype":"command","commandType":"auto","position":65.875,"command":"val df2 = customerDf\n.select(\"lastname\",\"firstname\",\"customer_id\")\n// .withColumn(\"from\",lit(\"df2\"))","commandVersion":22,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ee60a392-4e7c-4fd8-ac7f-bf92b0e3edf3"},{"version":"CommandV1","origId":1965691013914962,"guid":"d4a3cbaa-ff8f-4397-8094-c910b505268c","subtype":"command","commandType":"auto","position":66.875,"command":"df1.unionByName(df2).distinct.where(\"customer_id = 45721\").show","commandVersion":19,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"222d742f-8814-4cea-8e45-14c35217ac2d"},{"version":"CommandV1","origId":1965691013914963,"guid":"bf7dab34-465d-4648-8064-1a3bbd25abf4","subtype":"command","commandType":"auto","position":69.375,"command":"val customerWithAddr = customerDf\n.join(addressDf, customerDf(\"address_id\") === addressDf(\"address_id\"))","commandVersion":83,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4218616f-6e5e-4ede-9f6e-9441a0f6b08b"},{"version":"CommandV1","origId":1965691013914964,"guid":"3776b19a-35a5-4895-a5a6-c7ab2383cd93","subtype":"command","commandType":"auto","position":70.375,"command":"customerWithAddr.count","commandVersion":2,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7420c015-66d6-473a-8024-d5f9891e9f2a"},{"version":"CommandV1","origId":1965691013914965,"guid":"d2f37a5d-cc04-4844-afb7-2bfc7f97a18f","subtype":"command","commandType":"auto","position":71.375,"command":"customerWithAddr.cache.count","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"88a24e5c-2f8c-4f1a-bebd-6e009982b6fb"},{"version":"CommandV1","origId":1965691013914966,"guid":"0b96bd5b-65de-4ef5-913d-0c9f3d58de6f","subtype":"command","commandType":"auto","position":72.375,"command":"customerWithAddr.count","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c7b71c88-33d4-4e07-b13c-c0ec51eb46eb"},{"version":"CommandV1","origId":1965691013914967,"guid":"1c2a2803-86a8-400a-82f8-100eec2c46b8","subtype":"command","commandType":"auto","position":73.375,"command":"customerWithAddr.unpersist.count","commandVersion":8,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8fec5e0d-3de3-41d2-b0b6-3d28f438b9ed"},{"version":"CommandV1","origId":1965691013914968,"guid":"220df6e3-f9bb-46b0-b85c-ef3ed9415f1d","subtype":"command","commandType":"auto","position":74.375,"command":"import org.apache.spark.storage.StorageLevel","commandVersion":13,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a974cf64-36db-4908-af5d-a38cd0d4cc2b"},{"version":"CommandV1","origId":1965691013914969,"guid":"74bc1a19-2494-4868-9b08-c117c629c401","subtype":"command","commandType":"auto","position":75.375,"command":"customerWithAddr.persist(StorageLevel.MEMORY_AND_DISK).count","commandVersion":11,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"10cd117d-2e5c-4921-8bd1-3a656ca69a18"},{"version":"CommandV1","origId":1965691013914970,"guid":"289686e0-2155-4187-a4ea-f038c621379d","subtype":"command","commandType":"auto","position":76.375,"command":"customerWithAddr.count","commandVersion":2,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7ab3910a-65a2-4d9e-b02b-80ea1d3f0748"},{"version":"CommandV1","origId":1965691013914971,"guid":"7db63575-f179-4d89-8419-5ad77ededbc0","subtype":"command","commandType":"auto","position":77.375,"command":"customerWithAddr.storageLevel","commandVersion":4,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"98d89105-b3d6-418e-8702-2f1aef7b04d6"},{"version":"CommandV1","origId":1965691013914972,"guid":"e159810f-7bc8-41fe-8ead-c07685b10c14","subtype":"command","commandType":"auto","position":78.375,"command":"customerWithAddr.unpersist.count","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5ebf4682-4687-4e91-9b06-4059a7fc608f"},{"version":"CommandV1","origId":1965691013914973,"guid":"b2feeaa6-aa29-42ef-b4d6-9f3401726878","subtype":"command","commandType":"auto","position":79.375,"command":"customerWithAddr.persist(StorageLevel.MEMORY_ONLY_SER_2).count","commandVersion":14,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3e337310-3e1d-4ef1-97ec-e8304b7a134b"},{"version":"CommandV1","origId":1965691013914974,"guid":"acceedf3-2f03-4e83-9118-0e2e6e6b4890","subtype":"command","commandType":"auto","position":80.375,"command":"customerWithAddr.storageLevel","commandVersion":3,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"aaf8a603-a4d2-4336-b350-b176d8e52a92"},{"version":"CommandV1","origId":1965691013914975,"guid":"6d775bd7-1425-4dfc-b2ec-98e45f513de4","subtype":"command","commandType":"auto","position":81.375,"command":"customerWithAddr.storageLevel","commandVersion":1,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"dddafa2a-7c51-48e0-a8ba-7a3e5962981e"},{"version":"CommandV1","origId":1965691013914976,"guid":"11ec2b59-779c-420d-a923-75163c55d5d5","subtype":"command","commandType":"auto","position":82.375,"command":"customerWithAddr.show","commandVersion":5,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"wadson@insightahead.com","latestUserId":"4218386567210383","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f0c24782-bb10-4cde-b315-868ef24d33e2"}],"dashboards":[],"guid":"6f687b65-91b7-4717-bd8f-d19c5150a9f9","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}